<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard de Funil de Tráfego Orgânico</title>
    <!-- Tailwind CSS via CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Google Fonts: Inter -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <!-- Font Awesome for Icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css">
    <style>
        /* Estilo base para a fonte Inter */
        body {
            font-family: 'Inter', sans-serif;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
        }
        /* Efeito de hover sutil para os cards */
        .card-hover:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
        }
        /* Estilos para o modal */
        .modal-backdrop {
            background-color: rgba(0,0,0,0.7);
        }
        /* Estilos para o carrossel do calendário */
        #calendar-carousel::-webkit-scrollbar { height: 8px; }
        #calendar-carousel::-webkit-scrollbar-track { background: #2d3748; border-radius: 10px; }
        #calendar-carousel::-webkit-scrollbar-thumb { background: #4a5568; border-radius: 10px; }
        #calendar-carousel::-webkit-scrollbar-thumb:hover { background: #718096; }
        .period-btn-active { background-color: #0891b2; color: white; }
    </style>
</head>
<body class="bg-gray-900 text-gray-200">

    <!-- Container da View Principal (Dashboard) -->
    <div id="dashboard-view">
        <div class="container mx-auto p-4 sm:p-6 lg:p-8">
            <header class="text-center mb-10">
                <h1 class="text-4xl font-bold text-white tracking-tight">Dashboard de Conteúdo e Funil</h1>
                <p class="mt-2 text-lg text-cyan-400">Organize sua estratégia de tráfego orgânico e métricas.</p>
            </header>

            <main class="space-y-12">
                 <!-- 1. Seção: Padronização de Tipos de Posts -->
                 <section id="tipos-de-post">
                    <h2 class="text-3xl font-bold text-white mb-6 border-l-4 border-cyan-500 pl-4">1. Padronização de Posts</h2>
                    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                        <div class="bg-gray-800 p-6 rounded-lg border border-gray-700 transition-all duration-300 card-hover"><h3 class="text-xl font-semibold text-green-400">Testes Diários (Stories)</h3><p class="mt-2 text-gray-400">Fotos ou vídeos com duração de 24 horas.</p></div>
                        <div class="bg-gray-800 p-6 rounded-lg border border-gray-700 transition-all duration-300 card-hover"><h3 class="text-xl font-semibold text-pink-400">Cortes (Reels, TikTok)</h3><p class="mt-2 text-gray-400">Vídeos de 15s a 60s.</p></div>
                        <div class="bg-gray-800 p-6 rounded-lg border border-gray-700 transition-all duration-300 card-hover"><h3 class="text-xl font-semibold text-purple-400">Curtas</h3><p class="mt-2 text-gray-400">Vídeos de 1min a 30min.</p></div>
                        <div class="bg-gray-800 p-6 rounded-lg border border-gray-700 transition-all duration-300 card-hover"><h3 class="text-xl font-semibold text-yellow-400">Apresentações (Carrosséis)</h3><p class="mt-2 text-gray-400">Montagens e designs gráficos.</p></div>
                        <div class="bg-gray-800 p-6 rounded-lg border border-gray-700 transition-all duration-300 card-hover"><h3 class="text-xl font-semibold text-red-400">Longas</h3><p class="mt-2 text-gray-400">Vídeos com mais de 30min.</p></div>
                        <div class="bg-gray-800 p-6 rounded-lg border border-gray-700 transition-all duration-300 card-hover"><h3 class="text-xl font-semibold text-cyan-400">Provas Sociais (Feed)</h3><p class="mt-2 text-gray-400">Fotos e documentos que validam seu trabalho.</p></div>
                    </div>
                </section>

                <!-- 2. Seção: Estrutura do Funil -->
                <section id="funil">
                    <h2 class="text-3xl font-bold text-white mb-6 border-l-4 border-cyan-500 pl-4">2. Estrutura do Funil</h2>
                    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6">
                        <div class="bg-gray-800 p-6 rounded-lg border border-gray-700"><h3 class="text-xl font-semibold text-cyan-400 mb-3">Marketing (Atração)</h3><ul class="space-y-2 text-gray-300"><li>Instagram</li><li>Facebook</li><li>TikTok</li><li>YouTube</li><li>Twitch</li><li>Netflix</li></ul></div>
                        <div class="bg-gray-800 p-6 rounded-lg border border-gray-700"><h3 class="text-xl font-semibold text-cyan-400 mb-3">Relacionamento</h3><ul class="space-y-2 text-gray-300"><li>WhatsApp</li><li>Telegram</li><li>Discord</li><li>Hotmart</li><li>Sparkle</li></ul></div>
                        <div class="bg-gray-800 p-6 rounded-lg border border-gray-700"><h3 class="text-xl font-semibold text-cyan-400 mb-3">Vendas B2C</h3><ul class="space-y-2 text-gray-300"><li>Site Próprio</li><li>Landing Page</li><li>Marketplaces</li><li>WhatsApp Business</li></ul></div>
                        <div class="bg-gray-800 p-6 rounded-lg border border-gray-700"><h3 class="text-xl font-semibold text-cyan-400 mb-3">Negócios B2B</h3><ul class="space-y-2 text-gray-300"><li>Google Workspace</li><li>LinkedIn</li></ul></div>
                    </div>
                </section>

                <!-- 3. Seção: Métricas Relevantes (Calculadora) -->
                <section id="metricas">
                    <h2 class="text-3xl font-bold text-white mb-6 border-l-4 border-cyan-500 pl-4">3. Calculadora de Métricas</h2>
                    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                        <div class="bg-gray-800 p-6 rounded-lg border border-gray-700 space-y-3"><h3 class="text-xl font-semibold text-cyan-400">Stories</h3><input type="number" id="stories-views" placeholder="Visualizações" class="w-full bg-gray-700 text-white p-2 rounded-md border border-gray-600 focus:ring-2 focus:ring-cyan-500 focus:outline-none"><input type="number" id="stories-interacoes" placeholder="Directs + Interações" class="w-full bg-gray-700 text-white p-2 rounded-md border border-gray-600 focus:ring-2 focus:ring-cyan-500 focus:outline-none"><button onclick="calcularStories()" class="w-full bg-cyan-600 hover:bg-cyan-700 text-white font-bold py-2 px-4 rounded-md transition-colors">Calcular</button><p class="text-center text-lg mt-2">Score: <span id="stories-resultado" class="font-bold text-white">0</span></p></div>
                        <div class="bg-gray-800 p-6 rounded-lg border border-gray-700 space-y-3"><h3 class="text-xl font-semibold text-cyan-400">Reels</h3><input type="number" id="reels-views" placeholder="Visualizações" class="w-full bg-gray-700 text-white p-2 rounded-md border border-gray-600 focus:ring-2 focus:ring-cyan-500 focus:outline-none"><input type="number" id="reels-compartilhamentos" placeholder="Compartilhamentos" class="w-full bg-gray-700 text-white p-2 rounded-md border border-gray-600 focus:ring-2 focus:ring-cyan-500 focus:outline-none"><button onclick="calcularReels()" class="w-full bg-cyan-600 hover:bg-cyan-700 text-white font-bold py-2 px-4 rounded-md transition-colors">Calcular</button><p class="text-center text-lg mt-2">Score: <span id="reels-resultado" class="font-bold text-white">0</span></p></div>
                        <div class="bg-gray-800 p-6 rounded-lg border border-gray-700 space-y-3"><h3 class="text-xl font-semibold text-cyan-400">Fotos no Feed</h3><input type="number" id="feed-views" placeholder="Visualizações" class="w-full bg-gray-700 text-white p-2 rounded-md border border-gray-600 focus:ring-2 focus:ring-cyan-500 focus:outline-none"><input type="number" id="feed-interacoes" placeholder="Curtidas + Comentários" class="w-full bg-gray-700 text-white p-2 rounded-md border border-gray-600 focus:ring-2 focus:ring-cyan-500 focus:outline-none"><button onclick="calcularFeed()" class="w-full bg-cyan-600 hover:bg-cyan-700 text-white font-bold py-2 px-4 rounded-md transition-colors">Calcular</button><p class="text-center text-lg mt-2">Score: <span id="feed-resultado" class="font-bold text-white">0</span></p></div>
                        <div class="bg-gray-800 p-6 rounded-lg border border-gray-700 space-y-3"><h3 class="text-xl font-semibold text-cyan-400">Carrossel</h3><input type="number" id="carrossel-views" placeholder="Visualizações" class="w-full bg-gray-700 text-white p-2 rounded-md border border-gray-600 focus:ring-2 focus:ring-cyan-500 focus:outline-none"><input type="number" id="carrossel-salvamentos" placeholder="Salvamentos" class="w-full bg-gray-700 text-white p-2 rounded-md border border-gray-600 focus:ring-2 focus:ring-cyan-500 focus:outline-none"><button onclick="calcularCarrossel()" class="w-full bg-cyan-600 hover:bg-cyan-700 text-white font-bold py-2 px-4 rounded-md transition-colors">Calcular</button><p class="text-center text-lg mt-2">Score: <span id="carrossel-resultado" class="font-bold text-white">0</span></p></div>
                        <div class="bg-gray-800 p-6 rounded-lg border border-gray-700 space-y-3"><h3 class="text-xl font-semibold text-cyan-400">Longa Metragem</h3><input type="number" id="longa-tempo-medio" placeholder="Tempo médio assistido (seg)" class="w-full bg-gray-700 text-white p-2 rounded-md border border-gray-600 focus:ring-2 focus:ring-cyan-500 focus:outline-none"><input type="number" id="longa-duracao" placeholder="Duração do vídeo (seg)" class="w-full bg-gray-700 text-white p-2 rounded-md border border-gray-600 focus:ring-2 focus:ring-cyan-500 focus:outline-none"><button onclick="calcularLonga()" class="w-full bg-cyan-600 hover:bg-cyan-700 text-white font-bold py-2 px-4 rounded-md transition-colors">Calcular</button><p class="text-center text-lg mt-2">Score: <span id="longa-resultado" class="font-bold text-white">0</span></p></div>
                        <div class="bg-gray-800 p-6 rounded-lg border border-gray-700 space-y-3"><h3 class="text-xl font-semibold text-cyan-400">Curta Metragem</h3><input type="number" id="curta-tempo-total" placeholder="Tempo total assistido (seg)" class="w-full bg-gray-700 text-white p-2 rounded-md border border-gray-600 focus:ring-2 focus:ring-cyan-500 focus:outline-none"><input type="number" id="curta-duracao" placeholder="Duração do vídeo (seg)" class="w-full bg-gray-700 text-white p-2 rounded-md border border-gray-600 focus:ring-2 focus:ring-cyan-500 focus:outline-none"><button onclick="calcularCurta()" class="w-full bg-cyan-600 hover:bg-cyan-700 text-white font-bold py-2 px-4 rounded-md transition-colors">Calcular</button><p class="text-center text-lg mt-2">Score: <span id="curta-resultado" class="font-bold text-white">0</span></p></div>
                    </div>
                </section>
                
                <!-- 4. Seção: Calendário de Conteúdo -->
                <section id="calendario">
                    <h2 class="text-3xl font-bold text-white mb-6 border-l-4 border-cyan-500 pl-4">4. Calendário de Conteúdo</h2>
                    <div class="bg-gray-800 p-6 rounded-lg border border-gray-700">
                        <div class="flex justify-between items-center mb-4">
                            <button id="prev-month" class="px-4 py-2 bg-gray-700 rounded-md hover:bg-cyan-600 transition-colors">&lt;</button>
                            <h3 id="month-year" class="text-xl font-semibold text-white"></h3>
                            <button id="next-month" class="px-4 py-2 bg-gray-700 rounded-md hover:bg-cyan-600 transition-colors">&gt;</button>
                        </div>
                        <div id="calendar-carousel" class="flex overflow-x-auto space-x-4 pb-4">
                            <!-- Day cards serão gerados aqui -->
                        </div>
                    </div>
                </section>
            </main>
            
            <footer class="text-center mt-12 py-6 border-t border-gray-700">
                <p class="text-gray-500">Desenvolvido para organização de conteúdo digital.</p>
            </footer>
        </div>
    </div>

    <!-- Container da View do Dia (Planejamento) -->
    <div id="day-view" class="hidden min-h-screen flex-col p-4 sm:p-6 lg:p-8">
        <header class="flex items-center justify-between mb-6">
            <button id="day-view-back-btn" class="px-4 py-2 bg-gray-700 rounded-md hover:bg-cyan-600 transition-colors flex items-center">
                <i class="fas fa-arrow-left mr-2"></i> Voltar ao Dashboard
            </button>
            <h2 id="day-view-date" class="text-2xl sm:text-3xl font-bold text-white text-center"></h2>
            <div class="w-32"></div> <!-- Espaçador -->
        </header>
        <div class="bg-gray-800 p-6 rounded-lg border border-gray-700 flex-grow flex flex-col">
            <div id="day-view-timeline" class="space-y-4 flex-grow overflow-y-auto pr-2"></div>
        </div>
    </div>

    <!-- Container da View do Post (Imersiva) -->
    <div id="post-view" class="hidden min-h-screen flex-col p-4 sm:p-6 lg:p-8">
        <header class="flex items-center justify-between mb-6">
             <button id="post-view-back-btn" class="px-4 py-2 bg-gray-700 rounded-md hover:bg-cyan-600 transition-colors flex items-center">
                <i class="fas fa-arrow-left mr-2"></i> Voltar para o Dia
            </button>
            <h2 id="post-view-title" class="text-2xl sm:text-3xl font-bold text-white text-center truncate px-4"></h2>
             <div class="w-36"></div> <!-- Espaçador -->
        </header>
        <main class="grid grid-cols-1 lg:grid-cols-3 gap-6 flex-grow">
            <!-- Bloco 1: Pré-produção -->
            <div id="pre-producao-block" class="bg-gray-800 p-6 rounded-lg border border-gray-700 flex flex-col"></div>
            <!-- Bloco 2: Distribuição -->
            <div id="distribuicao-block" class="bg-gray-800 p-6 rounded-lg border border-gray-700"></div>
            <!-- Bloco 3: Analytics -->
            <div id="analytics-block" class="bg-gray-800 p-6 rounded-lg border border-gray-700"></div>
        </main>
    </div>
    
    <!-- Modal de Configuração de Período -->
    <div id="period-config-modal" class="fixed inset-0 z-50 items-center justify-center hidden">
        <div class="modal-backdrop fixed inset-0" onclick="closeAllModals()"></div>
        <div class="bg-gray-800 rounded-lg shadow-xl w-11/12 md:w-1/2 lg:w-1/3 max-w-lg mx-auto p-6 relative">
            <h3 class="text-2xl font-bold text-white mb-4">Configurar Período</h3>
            <div class="space-y-4">
                <div>
                    <label class="block mb-2 text-sm font-medium text-gray-300">1. Escolha o turno:</label>
                    <div class="flex justify-center rounded-md bg-gray-700 p-1" role="group">
                        <button id="config-period-am" class="px-5 py-2 text-sm font-medium rounded-md flex-1 transition-colors">Manhã</button>
                        <button id="config-period-pm" class="px-5 py-2 text-sm font-medium rounded-md flex-1 transition-colors">Tarde/Noite</button>
                    </div>
                </div>
                <div>
                    <label class="block mb-2 text-sm font-medium text-gray-300">2. Escolha de 1 a 3 blocos de horário:</label>
                    <div id="config-time-blocks" class="grid grid-cols-3 gap-2"></div>
                </div>
                <div class="flex justify-end space-x-3 pt-2">
                    <button type="button" onclick="closeAllModals()" class="px-4 py-2 bg-gray-600 text-white rounded-md hover:bg-gray-700 transition-colors">Cancelar</button>
                    <button type="button" id="confirm-period-btn" class="px-4 py-2 bg-cyan-600 text-white rounded-md hover:bg-cyan-700 transition-colors opacity-50 cursor-not-allowed" disabled>Planejar Período</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal de Ideação de Post -->
    <div id="ideation-modal" class="fixed inset-0 z-50 items-center justify-center hidden">
        <div class="modal-backdrop fixed inset-0" onclick="closeAllModals()"></div>
        <div class="bg-gray-800 rounded-lg shadow-xl w-11/12 md:w-1/2 lg:w-1/3 max-w-lg mx-auto p-6 relative">
            <h3 id="ideation-modal-title" class="text-2xl font-bold text-white mb-4"></h3>
            <form id="ideation-form" class="space-y-4">
                 <input type="hidden" id="ideation-post-id">
                 <div>
                    <label for="ideation-post-type" class="block mb-2 text-sm font-medium text-gray-300">Tipo de Post</label>
                    <select id="ideation-post-type" class="w-full bg-gray-700 text-white p-2 rounded-md border border-gray-600 focus:ring-2 focus:ring-cyan-500 focus:outline-none" required>
                        <option value="stories">Stories</option>
                        <option value="cortes">Cortes (Reels, TikTok)</option>
                        <option value="curtas">Curtas</option>
                        <option value="apresentacoes">Apresentações (Carrossel)</option>
                        <option value="longas">Longas</option>
                        <option value="provas">Provas Sociais</option>
                    </select>
                 </div>
                 <div><label for="ideation-post-tema" class="block mb-2 text-sm font-medium text-gray-300">Tema</label><input type="text" id="ideation-post-tema" class="w-full bg-gray-700 text-white p-2 rounded-md border border-gray-600 focus:ring-2 focus:ring-cyan-500 focus:outline-none" required></div>
                 <div><label for="ideation-post-formato" class="block mb-2 text-sm font-medium text-gray-300">Formato (Ex: Lo-fi, Tutorial, Review)</label><input type="text" id="ideation-post-formato" class="w-full bg-gray-700 text-white p-2 rounded-md border border-gray-600 focus:ring-2 focus:ring-cyan-500 focus:outline-none" required></div>
                 <div><label for="ideation-post-roteiro" class="block mb-2 text-sm font-medium text-gray-300">Roteiro / Ideia Central</label><textarea id="ideation-post-roteiro" rows="4" class="w-full bg-gray-700 text-white p-2 rounded-md border border-gray-600 focus:ring-2 focus:ring-cyan-500 focus:outline-none"></textarea></div>
                 <div class="flex justify-end space-x-3 pt-2">
                     <button type="button" onclick="closeAllModals()" class="px-4 py-2 bg-gray-600 text-white rounded-md hover:bg-gray-700 transition-colors">Cancelar</button>
                     <button type="submit" class="px-4 py-2 bg-cyan-600 text-white rounded-md hover:bg-cyan-700 transition-colors">Salvar Ideia</button>
                 </div>
            </form>
        </div>
    </div>
    
    <!-- Modal de Distribuição de Post -->
    <div id="distribution-modal" class="fixed inset-0 z-50 items-center justify-center hidden">
        <div class="modal-backdrop fixed inset-0" onclick="closeAllModals()"></div>
        <div class="bg-gray-800 rounded-lg shadow-xl w-11/12 md:w-1/2 lg:w-1/3 max-w-lg mx-auto p-6 relative max-h-[90vh] flex flex-col">
            <h3 class="text-2xl font-bold text-white mb-4">Etapa 2: Distribuição</h3>
            <form id="distribution-form" class="space-y-3 overflow-y-auto pr-2 flex-grow">
                <input type="hidden" id="distribution-post-id">
                <div><label for="distribution-post-titulo" class="block text-sm font-medium text-gray-300">Título</label><input type="text" id="distribution-post-titulo" class="w-full bg-gray-700 text-white p-2 rounded-md border border-gray-600 focus:ring-2 focus:ring-cyan-500 focus:outline-none" required></div>
                <div><label for="distribution-post-descricao" class="block text-sm font-medium text-gray-300">Descrição</label><textarea id="distribution-post-descricao" rows="3" class="w-full bg-gray-700 text-white p-2 rounded-md border border-gray-600 focus:ring-2 focus:ring-cyan-500 focus:outline-none"></textarea></div>
                <div><label for="distribution-post-hashtags" class="block text-sm font-medium text-gray-300">Hashtags</label><input type="text" id="distribution-post-hashtags" class="w-full bg-gray-700 text-white p-2 rounded-md border border-gray-600 focus:ring-2 focus:ring-cyan-500 focus:outline-none"></div>
                <div><label for="distribution-post-cta" class="block text-sm font-medium text-gray-300">CTA (Call to Action)</label><input type="text" id="distribution-post-cta" class="w-full bg-gray-700 text-white p-2 rounded-md border border-gray-600 focus:ring-2 focus:ring-cyan-500 focus:outline-none"></div>
                <div><label for="distribution-post-links" class="block text-sm font-medium text-gray-300">Links</label><textarea id="distribution-post-links" rows="2" class="w-full bg-gray-700 text-white p-2 rounded-md border border-gray-600 focus:ring-2 focus:ring-cyan-500 focus:outline-none"></textarea></div>
                <div><label for="distribution-post-capa" class="block text-sm font-medium text-gray-300">URL da Capa</label><input type="url" id="distribution-post-capa" class="w-full bg-gray-700 text-white p-2 rounded-md border border-gray-600 focus:ring-2 focus:ring-cyan-500 focus:outline-none"></div>
                <div>
                    <label class="block text-sm font-medium text-gray-300 mb-2">Plataformas</label>
                    <div id="distribution-platforms" class="grid grid-cols-2 gap-2 text-sm"></div>
                </div>
            </form>
             <div class="flex justify-end space-x-3 pt-4 mt-2 border-t border-gray-700">
                <button type="button" onclick="closeAllModals()" class="px-4 py-2 bg-gray-600 text-white rounded-md hover:bg-gray-700 transition-colors">Cancelar</button>
                <button type="submit" form="distribution-form" class="px-4 py-2 bg-cyan-600 text-white rounded-md hover:bg-cyan-700 transition-colors">Salvar Distribuição</button>
            </div>
        </div>
    </div>

    <!-- JavaScript para as calculadoras e calendário -->
    <script>
        // --- Lógica das Calculadoras (Dashboard) ---
        function getValueAsFloat(id) { return parseFloat(document.getElementById(id).value) || 0; }
        function calcularStories() { document.getElementById('stories-resultado').textContent = (getValueAsFloat('stories-views') * getValueAsFloat('stories-interacoes')).toLocaleString('pt-BR'); }
        function calcularReels() { document.getElementById('reels-resultado').textContent = (getValueAsFloat('reels-views') * getValueAsFloat('reels-compartilhamentos')).toLocaleString('pt-BR'); }
        function calcularFeed() { document.getElementById('feed-resultado').textContent = (getValueAsFloat('feed-views') * getValueAsFloat('feed-interacoes')).toLocaleString('pt-BR'); }
        function calcularCarrossel() { document.getElementById('carrossel-resultado').textContent = (getValueAsFloat('carrossel-views') * getValueAsFloat('carrossel-salvamentos')).toLocaleString('pt-BR'); }
        function calcularLonga() { document.getElementById('longa-resultado').textContent = (getValueAsFloat('longa-tempo-medio') * getValueAsFloat('longa-duracao')).toLocaleString('pt-BR'); }
        function calcularCurta() { document.getElementById('curta-resultado').textContent = (getValueAsFloat('curta-tempo-total') * getValueAsFloat('curta-duracao')).toLocaleString('pt-BR'); }
        
        // --- Lógica do App ---
        const dashboardView = document.getElementById('dashboard-view');
        const dayView = document.getElementById('day-view');
        const postView = document.getElementById('post-view');
        
        const monthYearEl = document.getElementById('month-year');
        const calendarCarouselEl = document.getElementById('calendar-carousel');
        const prevMonthBtn = document.getElementById('prev-month');
        const nextMonthBtn = document.getElementById('next-month');
        
        const periodConfigModal = document.getElementById('period-config-modal');
        const ideationModal = document.getElementById('ideation-modal');
        const distributionModal = document.getElementById('distribution-modal');
        
        const ideationForm = document.getElementById('ideation-form');
        const distributionForm = document.getElementById('distribution-form');

        let currentDate = new Date();
        let postsData = JSON.parse(localStorage.getItem('calendarPosts')) || {};
        
        let currentDayViewDate = null;
        let currentPostId = null;
        
        let configSelectedPeriod = 'am';
        let configSelectedBlocks = [];
        
        let activeDayViewPeriod = 'am';
        let activeDayViewBlocks = [];

        const POST_VISUALS = {
            stories: { icon: 'fa-square', color: 'bg-green-500', textColor: 'text-green-400' },
            cortes: { icon: 'fa-rectangle-vertical', color: 'bg-pink-500', textColor: 'text-pink-400' },
            curtas: { icon: 'custom-curtas', color: 'bg-pink-500', textColor: 'text-pink-400' },
            apresentacoes: { icon: 'fa-clone', color: 'bg-yellow-500', textColor: 'text-yellow-400' },
            longas: { icon: 'fa-rectangle-horizontal', color: 'bg-red-500', textColor: 'text-red-400' },
            provas: { icon: 'fa-circle', color: 'bg-cyan-500', textColor: 'text-cyan-400' }
        };

        const PLATFORMS = ['Instagram', 'Facebook', 'TikTok', 'YouTube', 'Twitch', 'LinkedIn', 'Site/Blog'];

        function savePosts() { localStorage.setItem('calendarPosts', JSON.stringify(postsData)); }

        // --- Renderização de Views ---
        function renderCalendar() {
            calendarCarouselEl.innerHTML = '';
            const month = currentDate.getMonth();
            const year = currentDate.getFullYear();
            const monthNames = ["Janeiro", "Fevereiro", "Março", "Abril", "Maio", "Junho", "Julho", "Agosto", "Setembro", "Outubro", "Novembro", "Dezembro"];
            monthYearEl.textContent = `${monthNames[month]} de ${year}`;
            const daysInMonth = new Date(year, month + 1, 0).getDate();
            const dayNames = ["Dom", "Seg", "Ter", "Qua", "Qui", "Sex", "Sáb"];

            for (let day = 1; day <= daysInMonth; day++) {
                const date = new Date(year, month, day);
                const dateStr = `${year}-${String(month + 1).padStart(2, '0')}-${String(day).padStart(2, '0')}`;
                
                const dayPostCounts = Object.keys(postsData)
                    .filter(key => key.startsWith(dateStr))
                    .reduce((acc, key) => {
                        const post = postsData[key];
                        if (post && post.type) acc[post.type] = (acc[post.type] || 0) + 1;
                        return acc;
                    }, {});

                let iconsHtml = '<div class="grid grid-cols-2 gap-x-2 gap-y-2 mt-2 w-full px-2">';
                const postTypeOrder = ['stories', 'cortes', 'curtas', 'apresentacoes', 'longas', 'provas'];

                postTypeOrder.forEach(type => {
                    const count = dayPostCounts[type] || 0;
                    const hasPosts = count > 0;
                    const visual = POST_VISUALS[type];
                    let iconContent = '';

                    if (type === 'curtas') {
                        const pinkColor = hasPosts ? 'bg-pink-500' : 'bg-gray-600';
                        const redColor = hasPosts ? 'bg-red-500' : 'bg-gray-500';
                        iconContent = `<div class="relative w-5 h-6 fa-fw flex items-center justify-center"><div class="absolute w-3 h-5 ${pinkColor} rounded-sm"></div><div class="absolute bottom-0 w-4 h-2 ${redColor} rounded-sm"></div></div>`;
                    } else {
                        iconContent = `<i class="fas ${visual.icon} fa-fw ${hasPosts ? visual.textColor : 'text-gray-500'} text-xl"></i>`;
                    }
                    
                    iconsHtml += `<div class="flex items-center">${iconContent}<span class="ml-1.5 font-bold text-sm ${hasPosts ? 'text-gray-100' : 'text-gray-500'}">${count}</span></div>`;
                });
                iconsHtml += '</div>';

                const dayEl = document.createElement('div');
                dayEl.className = 'flex-shrink-0 w-36 h-48 flex flex-col justify-start items-center p-2 rounded-lg bg-gray-700 cursor-pointer transition-all duration-300 hover:bg-cyan-700 hover:shadow-lg';
                dayEl.innerHTML = `<div class="text-center mb-1"><span class="font-semibold text-gray-400 text-sm">${dayNames[date.getDay()]}</span><span class="block text-4xl font-bold text-white">${day}</span></div><div class="flex-grow w-full flex items-center">${iconsHtml}</div>`;
                dayEl.dataset.date = dateStr;
                dayEl.onclick = () => openPeriodConfigModal(dateStr);
                
                const today = new Date();
                if (day === today.getDate() && month === today.getMonth() && year === today.getFullYear()) {
                    dayEl.classList.add('border-2', 'border-cyan-500', 'bg-gray-600');
                    dayEl.classList.remove('bg-gray-700');
                }
                calendarCarouselEl.appendChild(dayEl);
            }
        }

        // --- Navegação e Views ---
        function showDashboardView() {
            dashboardView.classList.remove('hidden');
            dayView.classList.add('hidden');
            postView.classList.add('hidden');
            renderCalendar();
        }

        function showDayView(dateStr, period, blocks) {
            currentDayViewDate = dateStr;
            activeDayViewPeriod = period;
            activeDayViewBlocks = blocks;
            dashboardView.classList.add('hidden');
            dayView.classList.remove('hidden');
            dayView.classList.add('flex');
            postView.classList.add('hidden');
            document.getElementById('day-view-date').textContent = new Date(dateStr + 'T00:00:00').toLocaleDateString('pt-BR', { weekday: 'long', day: 'numeric', month: 'long' });
            renderDayTimeline(period, blocks);
        }

        function showPostView(postId) {
            currentPostId = postId;
            const post = postsData[postId];
            if (!post) return;

            dashboardView.classList.add('hidden');
            dayView.classList.add('hidden');
            postView.classList.remove('hidden');
            postView.classList.add('flex');
            document.getElementById('post-view-title').textContent = post.titulo || post.tema || 'Novo Post';
            
            renderPreProducaoBlock(post);
            renderDistribuicaoBlock(post);
            renderAnalyticsBlock(post);
        }

        // --- Lógica de Modais ---
        function openPeriodConfigModal(dateStr) {
            currentDayViewDate = dateStr;
            configSelectedPeriod = 'am';
            configSelectedBlocks = [];
            renderPeriodConfigModalContent();
            periodConfigModal.style.display = 'flex';
        }
        
        function openIdeationModal(dateStr, hour, minute) {
            const hourStr = String(hour).padStart(2, '0');
            const minuteStr = String(minute).padStart(2, '0');
            const postId = `${dateStr}-${hourStr}-${minuteStr}`;
            
            document.getElementById('ideation-modal-title').textContent = `Ideia de Post para ${new Date(dateStr + 'T00:00:00').toLocaleDateString('pt-BR')} às ${hourStr}:${minuteStr}`;
            document.getElementById('ideation-post-id').value = postId;
            ideationForm.reset();
            ideationModal.style.display = 'flex';
        }

        function openDistributionModal(postId) {
            const post = postsData[postId];
            if (!post) return;

            document.getElementById('distribution-post-id').value = postId;
            distributionForm.reset();

            // Preencher com dados existentes
            document.getElementById('distribution-post-titulo').value = post.titulo || '';
            document.getElementById('distribution-post-descricao').value = post.descricao || '';
            document.getElementById('distribution-post-hashtags').value = post.hashtags || '';
            document.getElementById('distribution-post-cta').value = post.cta || '';
            document.getElementById('distribution-post-links').value = post.links || '';
            document.getElementById('distribution-post-capa').value = post.capa || '';

            const platformsContainer = document.getElementById('distribution-platforms');
            platformsContainer.innerHTML = '';
            PLATFORMS.forEach(platform => {
                const isChecked = post.plataformas?.includes(platform);
                platformsContainer.innerHTML += `
                    <label class="flex items-center space-x-2 cursor-pointer">
                        <input type="checkbox" value="${platform}" ${isChecked ? 'checked' : ''} class="form-checkbox bg-gray-600 border-gray-500 rounded text-cyan-500 focus:ring-cyan-600">
                        <span>${platform}</span>
                    </label>
                `;
            });

            distributionModal.style.display = 'flex';
        }

        function closeAllModals() {
            periodConfigModal.style.display = 'none';
            ideationModal.style.display = 'none';
            distributionModal.style.display = 'none';
        }

        // --- Renderização de Blocos e Conteúdo ---
        function renderDayTimeline(period, blocks) {
            const timelineEl = document.getElementById('day-view-timeline');
            timelineEl.innerHTML = '';
            blocks.sort((a, b) => a - b);
            const blockLabels = { am: ["00:00 - 03:59", "04:00 - 07:59", "08:00 - 11:59"], pm: ["12:00 - 15:59", "16:00 - 19:59", "20:00 - 23:59"] };

            blocks.forEach(block => {
                const header = document.createElement('h4');
                header.className = 'text-lg font-semibold text-cyan-400 pt-4 pb-2 border-t border-gray-700 first:border-t-0 first:pt-0';
                header.textContent = `Bloco: ${blockLabels[period][block]}`;
                timelineEl.appendChild(header);
                const startHour = period === 'am' ? block * 4 : 12 + block * 4;
                
                for (let i = 0; i < 4; i++) {
                    const hour = startHour + i;
                    const hourStr = String(hour).padStart(2, '0');
                    const hourRowEl = document.createElement('div');
                    hourRowEl.className = 'flex items-start';
                    hourRowEl.innerHTML = `<div class="font-bold w-12 text-gray-400 pt-2 text-sm">${hourStr}:00</div>`;
                    const slotsContainerEl = document.createElement('div');
                    slotsContainerEl.className = 'flex-grow grid grid-cols-3 sm:grid-cols-6 gap-1 ml-4';

                    for (let j = 0; j < 6; j++) {
                        const minute = j * 10;
                        const minuteStr = String(minute).padStart(2, '0');
                        const postId = `${currentDayViewDate}-${hourStr}-${minuteStr}`;
                        const post = postsData[postId];
                        
                        const slotEl = document.createElement('div');
                        slotEl.className = 'h-10 rounded-md flex items-center justify-center cursor-pointer transition-colors';
                        slotEl.onclick = () => { post ? showPostView(postId) : openIdeationModal(currentDayViewDate, hour, minute); };

                        if (post) {
                            slotEl.innerHTML = createPostVisual(post);
                            slotEl.title = post.titulo || post.tema;
                        } else {
                            slotEl.className += ' bg-gray-700 hover:bg-gray-600';
                            slotEl.innerHTML = `<i class="fa-solid fa-plus text-gray-500"></i>`;
                        }
                        slotsContainerEl.appendChild(slotEl);
                    }
                    hourRowEl.appendChild(slotsContainerEl);
                    timelineEl.appendChild(hourRowEl);
                }
            });
        }
        
        function createPostVisual(post) {
            const v = POST_VISUALS[post.type] || { icon: 'fa-question-circle', color: 'bg-gray-400' };
            if (post.type === 'curtas') {
                return `<div class="relative w-5 h-6 flex items-center justify-center" title="Curta"><div class="absolute w-3 h-5 ${v.color} rounded-sm"></div><div class="absolute bottom-0 w-4 h-2 bg-red-500 rounded-sm"></div></div>`;
            }
             if (post.type === 'apresentacoes') {
                 return `<div class="relative w-6 h-6" title="Apresentação"><div class="absolute top-1 left-1 w-5 h-5 ${v.color} rounded-sm opacity-70"></div><div class="absolute top-0 left-0 w-5 h-5 ${v.color} rounded-sm flex items-center justify-center text-white"><i class="fas ${v.icon} text-xs"></i></div></div>`;
             }
            return `<div class="flex items-center justify-center text-white w-6 h-6 ${v.color} rounded-sm"><i class="fas ${v.icon} text-base"></i></div>`;
        }
        
        function renderPreProducaoBlock(post) {
            const block = document.getElementById('pre-producao-block');
            const v = POST_VISUALS[post.type];
            block.innerHTML = `
                <h3 class="text-2xl font-bold text-white mb-4">1. Pré-produção</h3>
                <div class="flex-grow space-y-4 text-gray-300">
                    <p><strong>Tipo:</strong> <span class="px-2 py-1 ${v.color} text-white text-xs rounded-full">${post.type}</span></p>
                    <p><strong>Tema:</strong> ${post.tema || 'Não definido'}</p>
                    <p><strong>Formato:</strong> ${post.formato || 'Não definido'}</p>
                    <div><strong>Roteiro/Ideia:</strong><div class="mt-1 p-2 bg-gray-900 rounded-md text-sm whitespace-pre-wrap">${post.roteiro || 'Não definido'}</div></div>
                </div>
                <div class="flex space-x-2 mt-6">
                    <button onclick="handleDeletePost('${currentPostId}')" class="px-4 py-2 bg-red-600 text-white rounded-md hover:bg-red-700 transition-colors w-1/2">Deletar</button>
                    <button onclick="openDistributionModal('${currentPostId}')" class="px-4 py-2 bg-cyan-600 text-white rounded-md hover:bg-cyan-700 transition-colors w-1/2">Distribuir</button>
                </div>
            `;
        }

        function renderDistribuicaoBlock(post) {
            const block = document.getElementById('distribuicao-block');
            let content;
            if (post.status === 'distribuido') {
                content = `
                    <div class="space-y-3 text-gray-300 text-sm">
                        <p><strong>Título:</strong> ${post.titulo}</p>
                        <div><strong>Descrição:</strong><div class="mt-1 p-2 bg-gray-900 rounded-md whitespace-pre-wrap">${post.descricao || 'N/A'}</div></div>
                        <p><strong>Hashtags:</strong> <span class="text-cyan-400">${post.hashtags || 'N/A'}</span></p>
                        <p><strong>CTA:</strong> ${post.cta || 'N/A'}</p>
                        <p><strong>Links:</strong> <a href="${post.links}" target="_blank" class="text-cyan-400 hover:underline">${post.links || 'N/A'}</a></p>
                        <p><strong>Capa:</strong> ${post.capa ? `<img src="${post.capa}" class="mt-2 rounded-md max-h-24">` : 'N/A'}</p>
                        <p><strong>Plataformas:</strong> <span class="font-semibold">${post.plataformas?.join(', ') || 'N/A'}</span></p>
                    </div>
                `;
            } else {
                content = `
                    <div class="text-center text-gray-500 flex flex-col items-center justify-center h-full">
                        <i class="fas fa-paper-plane fa-3x mb-4"></i>
                        <p>Aguardando distribuição.</p>
                        <p class="text-xs">Clique no botão "Distribuir" no bloco de pré-produção.</p>
                    </div>
                `;
            }
             block.innerHTML = `<h3 class="text-2xl font-bold text-white mb-4">2. Distribuição</h3>${content}`;
        }

        function renderAnalyticsBlock(post) {
            const block = document.getElementById('analytics-block');
            let content;

            if (post.status !== 'distribuido') {
                content = `
                    <div class="text-center text-gray-500 flex flex-col items-center justify-center h-full">
                        <i class="fas fa-chart-line fa-3x mb-4"></i>
                        <p>Analytics ficará disponível após a distribuição do post.</p>
                    </div>
                `;
                 block.innerHTML = `<h3 class="text-2xl font-bold text-white mb-4">3. Analytics</h3>${content}`;
                 return;
            }

            const analytics = post.analytics || {};
            const calculators = {
                stories: { p1: 'Visualizações', p2: 'Directs + Interações' },
                reels: { p1: 'Visualizações', p2: 'Compartilhamentos' },
                cortes: { p1: 'Visualizações', p2: 'Compartilhamentos' },
                provas: { p1: 'Visualizações', p2: 'Curtidas + Comentários' },
                apresentacoes: { p1: 'Visualizações', p2: 'Salvamentos' },
                longas: { p1: 'Tempo médio (seg)', p2: 'Duração (seg)' },
                curtas: { p1: 'Tempo total (seg)', p2: 'Duração (seg)' }
            };
            const calc = calculators[post.type] || { p1: 'Input 1', p2: 'Input 2' };
            const score = (analytics.input1 || 0) * (analytics.input2 || 0);

            content = `
                <div class="space-y-3">
                    <input type="number" id="post-analytics-input1" placeholder="${calc.p1}" value="${analytics.input1 || ''}" class="w-full bg-gray-700 text-white p-2 rounded-md border border-gray-600">
                    <input type="number" id="post-analytics-input2" placeholder="${calc.p2}" value="${analytics.input2 || ''}" class="w-full bg-gray-700 text-white p-2 rounded-md border border-gray-600">
                    <button onclick="calculatePostAnalytics('${currentPostId}')" class="w-full bg-cyan-600 hover:bg-cyan-700 text-white font-bold py-2 px-4 rounded-md">Calcular & Salvar</button>
                    <p class="text-center text-lg mt-2">Score: <span id="post-analytics-result" class="font-bold text-white">${score.toLocaleString('pt-BR')}</span></p>
                </div>
            `;
            block.innerHTML = `<h3 class="text-2xl font-bold text-white mb-4">3. Analytics</h3>${content}`;
        }
        
        function calculatePostAnalytics(postId) {
            const post = postsData[postId];
            if (!post) return;
            const input1 = parseFloat(document.getElementById('post-analytics-input1').value) || 0;
            const input2 = parseFloat(document.getElementById('post-analytics-input2').value) || 0;
            
            post.analytics = { input1, input2 };
            savePosts();
            
            document.getElementById('post-analytics-result').textContent = (input1 * input2).toLocaleString('pt-BR');
        }

        // --- Handlers de Ações e Formulários ---
        function handleDeletePost(postId) {
            if (confirm('Tem certeza que deseja deletar este post? Esta ação não pode ser desfeita.')) {
                delete postsData[postId];
                savePosts();
                showDayView(currentDayViewDate, activeDayViewPeriod, activeDayViewBlocks);
            }
        }

        ideationForm.addEventListener('submit', (e) => {
            e.preventDefault();
            const postId = document.getElementById('ideation-post-id').value;
            postsData[postId] = {
                type: document.getElementById('ideation-post-type').value,
                tema: document.getElementById('ideation-post-tema').value,
                formato: document.getElementById('ideation-post-formato').value,
                roteiro: document.getElementById('ideation-post-roteiro').value,
                status: 'ideia'
            };
            savePosts();
            closeAllModals();
            renderDayTimeline(activeDayViewPeriod, activeDayViewBlocks);
        });

        distributionForm.addEventListener('submit', (e) => {
            e.preventDefault();
            const postId = document.getElementById('distribution-post-id').value;
            const post = postsData[postId];
            if (!post) return;
            
            const selectedPlatforms = Array.from(document.querySelectorAll('#distribution-platforms input:checked')).map(el => el.value);

            post.titulo = document.getElementById('distribution-post-titulo').value;
            post.descricao = document.getElementById('distribution-post-descricao').value;
            post.hashtags = document.getElementById('distribution-post-hashtags').value;
            post.cta = document.getElementById('distribution-post-cta').value;
            post.links = document.getElementById('distribution-post-links').value;
            post.capa = document.getElementById('distribution-post-capa').value;
            post.plataformas = selectedPlatforms;
            post.status = 'distribuido';

            savePosts();
            closeAllModals();
            showPostView(postId);
        });

        // --- Inicialização e Event Listeners ---
        prevMonthBtn.onclick = () => { currentDate.setMonth(currentDate.getMonth() - 1); renderCalendar(); };
        nextMonthBtn.onclick = () => { currentDate.setMonth(currentDate.getMonth() + 1); renderCalendar(); };
        document.getElementById('day-view-back-btn').onclick = showDashboardView;
        document.getElementById('post-view-back-btn').onclick = () => showDayView(currentDayViewDate, activeDayViewPeriod, activeDayViewBlocks);
        document.getElementById('config-period-am').onclick = () => { configSelectedPeriod = 'am'; configSelectedBlocks = []; renderPeriodConfigModalContent(); };
        document.getElementById('config-period-pm').onclick = () => { configSelectedPeriod = 'pm'; configSelectedBlocks = []; renderPeriodConfigModalContent(); };
        document.getElementById('confirm-period-btn').onclick = () => { if (configSelectedBlocks.length > 0) { closeAllModals(); showDayView(currentDayViewDate, configSelectedPeriod, configSelectedBlocks); }};

        function renderPeriodConfigModalContent() { /* ... Lógica existente ... */ }
        function renderPeriodConfigModalContent() {
            const periodAmBtn = document.getElementById('config-period-am');
            const periodPmBtn = document.getElementById('config-period-pm');
            const blocksContainer = document.getElementById('config-time-blocks');
            const confirmBtn = document.getElementById('confirm-period-btn');
            periodAmBtn.classList.toggle('period-btn-active', configSelectedPeriod === 'am');
            periodPmBtn.classList.toggle('period-btn-active', configSelectedPeriod === 'pm');
            const blocks = { am: ["00:00 - 03:59", "04:00 - 07:59", "08:00 - 11:59"], pm: ["12:00 - 15:59", "16:00 - 19:59", "20:00 - 23:59"] };
            blocksContainer.innerHTML = '';
            blocks[configSelectedPeriod].forEach((blockText, index) => {
                const blockBtn = document.createElement('button');
                blockBtn.textContent = blockText;
                blockBtn.className = 'px-3 py-2 text-sm font-medium rounded-md transition-colors';
                if(configSelectedBlocks.includes(index)) { blockBtn.classList.add('period-btn-active'); } 
                else { blockBtn.classList.add('border', 'border-gray-600', 'hover:bg-gray-700'); }
                blockBtn.onclick = () => {
                    const selectedIndex = configSelectedBlocks.indexOf(index);
                    if (selectedIndex > -1) { configSelectedBlocks.splice(selectedIndex, 1); } 
                    else { if (configSelectedBlocks.length < 3) { configSelectedBlocks.push(index); } }
                    renderPeriodConfigModalContent();
                };
                blocksContainer.appendChild(blockBtn);
            });
            if (configSelectedBlocks.length > 0) { confirmBtn.disabled = false; confirmBtn.classList.remove('opacity-50', 'cursor-not-allowed'); } 
            else { confirmBtn.disabled = true; confirmBtn.classList.add('opacity-50', 'cursor-not-allowed'); }
        }

        window.onclick = function(event) { if (event.target.classList.contains('modal-backdrop')) { closeAllModals(); } }

        // Renderização inicial
        renderCalendar();
    </script>
</body>
</html>

